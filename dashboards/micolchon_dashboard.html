<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MiColchón - Product Intelligence Dashboard | Sealmetrics</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            color: #1a202c;
            line-height: 1.6;
        }
        
        .dashboard {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            color: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .header .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 15px;
        }
        
        .header .meta {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .grid {
            display: grid;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .grid-1 { grid-template-columns: 1fr; }
        .grid-2 { grid-template-columns: 1fr 1fr; }
        .grid-3 { grid-template-columns: 1fr 1fr 1fr; }
        .grid-4 { grid-template-columns: 1fr 1fr 1fr 1fr; }
        
        .card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
        }
        
        .card h3 {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #2d3748;
        }
        
        .metric {
            text-align: center;
        }
        
        .metric-value {
            font-size: 2.8rem;
            font-weight: 800;
            margin-bottom: 8px;
        }
        
        .metric-value.positive { color: #48bb78; }
        .metric-value.negative { color: #f56565; }
        .metric-value.neutral { color: #4299e1; }
        
        .metric-label {
            font-size: 1rem;
            color: #718096;
            margin-bottom: 12px;
            font-weight: 500;
        }
        
        .metric-change {
            font-size: 0.9rem;
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 20px;
        }
        
        .metric-change.up {
            background: #c6f6d5;
            color: #22543d;
        }
        
        .metric-change.down {
            background: #fed7d7;
            color: #742a2a;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .table th,
        .table td {
            padding: 15px 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .table th {
            background: #f7fafc;
            font-weight: 600;
            color: #4a5568;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .table td {
            font-size: 0.95rem;
        }
        
        .insight-box {
            background: #f0fff4;
            border-left: 4px solid #48bb78;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .insight-box h4 {
            color: #22543d;
            margin-bottom: 10px;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .insight-box p {
            color: #2f855a;
            font-size: 1rem;
            line-height: 1.6;
        }
        
        .cta-section {
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            color: white;
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            margin: 30px 0;
        }
        
        .cta-button {
            background: white;
            color: #3182ce;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        
        .cta-button:hover {
            background: #f7fafc;
            transform: translateY(-2px);
        }
        
        .tag {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin: 2px;
        }
        
        .tag.high { background: #c6f6d5; color: #22543d; }
        .tag.medium { background: #fef5e7; color: #744210; }
        .tag.low { background: #fed7d7; color: #742a2a; }
        
        .channel-card {
            border-left: 4px solid;
            padding: 15px;
            margin: 10px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .facebook { border-color: #1877f2; background: #f0f8ff; }
        .google { border-color: #ea4335; background: #fff5f5; }
        .instagram { border-color: #e4405f; background: #fef5f8; }
        .tiktok { border-color: #000000; background: #f7fafc; }
        .email { border-color: #805ad5; background: #faf5ff; }
        
        .interactive-matrix {
            margin: 20px 0;
        }
        
        .interactive-matrix select {
            padding: 10px 15px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            margin-right: 15px;
            margin-bottom: 15px;
        }
        
        .interactive-matrix button {
            padding: 10px 20px;
            background: #4299e1;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .interactive-matrix button:hover {
            background: #3182ce;
        }
        
        .matrix-table {
            overflow-x: auto;
            margin-top: 20px;
        }
        
        .matrix-table table {
            min-width: 100%;
        }
        
        .matrix-table th {
            background: #2d3748;
            color: white;
            text-align: center;
            padding: 12px 8px;
            font-size: 0.85rem;
        }
        
        .matrix-table td {
            text-align: center;
            padding: 10px 8px;
        }
        
        .matrix-table .highlight {
            color: #48bb78;
            font-weight: bold;
        }
        
        .matrix-table .channel-row {
            font-weight: 600;
        }
        
        .matrix-table .average-row {
            background: #f4f4f5;
            font-weight: bold;
        }
        
        .matrix-table .total-cell {
            background: #4a5568;
            color: white;
            font-weight: bold;
        }
        
        @media (max-width: 768px) {
            .grid-2, .grid-3, .grid-4 {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .metric-value {
                font-size: 2.2rem;
            }
            
            .interactive-matrix select,
            .interactive-matrix button {
                width: 100%;
                margin-bottom: 10px;
            }
        }
        
        .live-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            background: #48bb78;
            border-radius: 50%;
            margin-right: 10px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <!-- Header Personalizado -->
        <div class="header">
            <h1><span class="live-indicator"></span>MiColchón.com - Product Intelligence Report</h1>
            <div class="subtitle">Análisis personalizado de optimización para el sector del descanso | Powered by Sealmetrics</div>
            <div class="meta">
                Generado el 13 de enero de 2025 | Datos últimas 4 semanas | 
                <strong>Confidencial para MiColchón</strong>
            </div>
        </div>

        <!-- KPIs Ejecutivos -->
        <div class="grid grid-4">
            <div class="card metric">
                <div class="metric-value positive">94%</div>
                <div class="metric-label">Visibilidad de Datos</div>
                <div class="metric-change up">vs 55% GA4 = +€32,400/mes revenue visibility</div>
            </div>
            
            <div class="card metric">
                <div class="metric-value neutral">€28,450</div>
                <div class="metric-label">Revenue Visibility/Mes</div>
                <div class="metric-change up">+85% vs GA4 = insights completos por medida-material</div>
            </div>
            
            <div class="card metric">
                <div class="metric-value positive">147</div>
                <div class="metric-label">Conversiones Últimas 4 Semanas</div>
                <div class="metric-change up">+23% vs período anterior = €18,900 revenue adicional</div>
            </div>
            
            <div class="card metric">
                <div class="metric-value neutral">€193</div>
                <div class="metric-label">AOV Promedio</div>
                <div class="metric-change up">Colchones King Size lideran con €387 AOV</div>
            </div>
        </div>

        <!-- Performance por Atributos -->
        <div class="grid grid-2">
            <div class="card">
                <h3>🛏️ Performance por Medida de Colchón</h3>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Medida</th>
                            <th>Conversiones</th>
                            <th>Conversion Rate</th>
                            <th>Mejor Canal</th>
                            <th>AOV</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>150x190 (Queen)</strong></td>
                            <td>42</td>
                            <td><span class="tag high">3.8%</span></td>
                            <td>Facebook Ads</td>
                            <td>€267</td>
                        </tr>
                        <tr>
                            <td><strong>135x190 (Matrimonio)</strong></td>
                            <td>38</td>
                            <td><span class="tag high">3.5%</span></td>
                            <td>Google Shopping</td>
                            <td>€234</td>
                        </tr>
                        <tr>
                            <td><strong>90x190 (Individual)</strong></td>
                            <td>31</td>
                            <td><span class="tag medium">2.9%</span></td>
                            <td>Instagram</td>
                            <td>€198</td>
                        </tr>
                        <tr>
                            <td><strong>160x190 (King)</strong></td>
                            <td>24</td>
                            <td><span class="tag high">4.2%</span></td>
                            <td>Email Marketing</td>
                            <td>€387</td>
                        </tr>
                        <tr>
                            <td><strong>180x200 (Super King)</strong></td>
                            <td>12</td>
                            <td><span class="tag high">4.8%</span></td>
                            <td>Google Ads</td>
                            <td>€456</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="insight-box">
                    <h4>🎯 Insights por Medida</h4>
                    <p>Medidas grandes (King/Super King) tienen mayor conversion rate pero menor volumen. Instagram domina Individual (target joven). Facebook optimal para Queen (familias jóvenes).</p>
                </div>
            </div>

            <div class="card">
                <h3>🧵 Performance por Material</h3>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Material</th>
                            <th>Conversiones</th>
                            <th>Conversion Rate</th>
                            <th>AOV</th>
                            <th>Revenue</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Viscoelástica</strong></td>
                            <td>56</td>
                            <td><span class="tag high">4.1%</span></td>
                            <td>€289</td>
                            <td>€16,184</td>
                        </tr>
                        <tr>
                            <td><strong>Muelles Ensacados</strong></td>
                            <td>48</td>
                            <td><span class="tag medium">3.2%</span></td>
                            <td>€198</td>
                            <td>€9,504</td>
                        </tr>
                        <tr>
                            <td><strong>Látex Natural</strong></td>
                            <td>23</td>
                            <td><span class="tag high">3.9%</span></td>
                            <td>€356</td>
                            <td>€8,188</td>
                        </tr>
                        <tr>
                            <td><strong>Híbrido</strong></td>
                            <td>15</td>
                            <td><span class="tag medium">3.1%</span></td>
                            <td>€423</td>
                            <td>€6,345</td>
                        </tr>
                        <tr>
                            <td><strong>Espuma HR</strong></td>
                            <td>5</td>
                            <td><span class="tag low">2.1%</span></td>
                            <td>€134</td>
                            <td>€670</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="insight-box">
                    <h4>💡 Insights por Material</h4>
                    <p>Viscoelástica lidera en conversiones y rate. Látex premium con AOV alto pero volumen bajo. Espuma HR requiere optimization - posible problema de posicionamiento/precio.</p>
                </div>
            </div>
        </div>

        <!-- Matriz Interactiva -->
        <div class="grid grid-1">
            <div class="card">
                <h3>📊 Matriz Interactiva: Canales vs Atributos de Producto</h3>
                
                <div class="interactive-matrix">
                    <label style="font-weight: 600; margin-right: 15px;">Seleccionar Atributo:</label>
                    <select id="attributeSelector">
                        <option value="medidas">Medidas de Colchón</option>
                        <option value="materiales">Materiales</option>
                        <option value="firmeza">Nivel de Firmeza</option>
                        <option value="precios">Rangos de Precio</option>
                    </select>
                    <button onclick="updateMatrix()">Actualizar Matrix</button>
                </div>
                
                <div class="matrix-table">
                    <table class="table" id="matrixTable">
                        <thead>
                            <tr id="matrixHeader">
                                <th>Canal / Medida</th>
                                <th>90x190</th>
                                <th>135x190</th>
                                <th>150x190</th>
                                <th>160x190</th>
                                <th>180x200</th>
                                <th style="background: #e2e8f0; color: #4a5568;">Media Canal</th>
                            </tr>
                        </thead>
                        <tbody id="matrixBody">
                            <tr class="channel-row facebook">
                                <td><strong>Facebook Ads</strong></td>
                                <td>2.8%</td>
                                <td>3.2%</td>
                                <td class="highlight">4.1%</td>
                                <td>3.6%</td>
                                <td>2.9%</td>
                                <td style="background: #e2e8f0;"><strong>3.3%</strong></td>
                            </tr>
                            <tr class="channel-row google">
                                <td><strong>Google Shopping</strong></td>
                                <td>2.1%</td>
                                <td class="highlight">3.8%</td>
                                <td>3.4%</td>
                                <td class="highlight">4.5%</td>
                                <td class="highlight">4.2%</td>
                                <td style="background: #e2e8f0;"><strong>3.6%</strong></td>
                            </tr>
                            <tr class="channel-row instagram">
                                <td><strong>Instagram</strong></td>
                                <td class="highlight">3.7%</td>
                                <td>3.1%</td>
                                <td>2.9%</td>
                                <td>2.4%</td>
                                <td>2.1%</td>
                                <td style="background: #e2e8f0;"><strong>2.8%</strong></td>
                            </tr>
                            <tr class="channel-row email">
                                <td><strong>Email Marketing</strong></td>
                                <td>3.2%</td>
                                <td>3.6%</td>
                                <td>3.8%</td>
                                <td class="highlight">4.8%</td>
                                <td class="highlight">5.1%</td>
                                <td style="background: #e2e8f0;"><strong>4.1%</strong></td>
                            </tr>
                            <tr class="channel-row tiktok">
                                <td><strong>TikTok Ads</strong></td>
                                <td>2.9%</td>
                                <td>2.3%</td>
                                <td>1.8%</td>
                                <td>1.4%</td>
                                <td>1.1%</td>
                                <td style="background: #e2e8f0;"><strong>1.9%</strong></td>
                            </tr>
                            <tr class="average-row">
                                <td class="total-cell"><strong>MEDIA SITE</strong></td>
                                <td>2.9%</td>
                                <td>3.2%</td>
                                <td>3.2%</td>
                                <td>3.3%</td>
                                <td>3.1%</td>
                                <td class="total-cell"><strong>3.1%</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="insight-box" id="matrixInsights">
                    <h4>🔍 Insights Dinámicos - Medidas</h4>
                    <p>Email Marketing domina medidas grandes (King/Super King) con 4.8-5.1% conversion. Instagram optimal para Individual (3.7%). Google Shopping strong en matrimonio tradicional. TikTok underperforming across all sizes.</p>
                </div>
            </div>
        </div>

        <!-- Análisis por Canal -->
        <div class="grid grid-2">
            <div class="card">
                <h3>🎯 Top Performing Channel-Product Combinations</h3>
                
                <div class="channel-card email">
                    <strong>Email Marketing + King Size Viscoelástica</strong> <br>
                    <span style="color: #48bb78; font-weight: bold;">5.2% Conversion Rate</span> | AOV: €435 | Revenue: €4,785
                    <br><em>Opportunity: Scale email sequences for premium products</em>
                </div>
                
                <div class="channel-card facebook">
                    <strong>Facebook Ads + Queen Muelles</strong> <br>
                    <span style="color: #48bb78; font-weight: bold;">4.1% Conversion Rate</span> | AOV: €267 | Revenue: €6,834
                    <br><em>Opportunity: Increase budget +40% for family targeting</em>
                </div>
                
                <div class="channel-card instagram">
                    <strong>Instagram + Individual Látex</strong> <br>
                    <span style="color: #48bb78; font-weight: bold;">3.7% Conversion Rate</span> | AOV: €198 | Revenue: €2,376
                    <br><em>Opportunity: Expand eco-friendly messaging to young audience</em>
                </div>
                
                <div class="channel-card google">
                    <strong>Google Shopping + Matrimonio Viscoelástica</strong> <br>
                    <span style="color: #48bb78; font-weight: bold;">3.8% Conversion Rate</span> | AOV: €289 | Revenue: €8,967
                    <br><em>Opportunity: Optimize product titles for comfort keywords</em>
                </div>
            </div>
            
            <div class="card">
                <h3>⚡ Oportunidades de Optimización Inmediata</h3>
                
                <table class="table">
                    <thead>
                        <tr>
                            <th>Acción</th>
                            <th>Canal-Producto</th>
                            <th>Revenue Impact</th>
                            <th>Prioridad</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Scale Budget +50%</strong></td>
                            <td>Email → King Size</td>
                            <td style="color: #48bb78; font-weight: bold;">+€2,400/mes</td>
                            <td><span class="tag high">Alta</span></td>
                        </tr>
                        <tr>
                            <td><strong>Improve TikTok Creative</strong></td>
                            <td>TikTok → Individual</td>
                            <td style="color: #48bb78; font-weight: bold;">+€1,800/mes</td>
                            <td><span class="tag high">Alta</span></td>
                        </tr>
                        <tr>
                            <td><strong>Expand Látex Targeting</strong></td>
                            <td>Facebook → Eco Segment</td>
                            <td style="color: #48bb78; font-weight: bold;">+€1,200/mes</td>
                            <td><span class="tag medium">Media</span></td>
                        </tr>
                        <tr>
                            <td><strong>A/B Test Firmeza Messaging</strong></td>
                            <td>Google Ads → All</td>
                            <td style="color: #48bb78; font-weight: bold;">+€900/mes</td>
                            <td><span class="tag medium">Media</span></td>
                        </tr>
                        <tr>
                            <td><strong>Cross-sell Almohadas</strong></td>
                            <td>Post-purchase Email</td>
                            <td style="color: #48bb78; font-weight: bold;">+€650/mes</td>
                            <td><span class="tag low">Baja</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Conclusiones y CTA -->
        <div class="grid grid-1">
            <div class="insight-box">
                <h4>🚀 Resumen Ejecutivo - Bottom Line</h4>
                <p><strong>Con Sealmetrics puedes identificar exactamente qué medida de colchón convierte mejor en cada canal.</strong> Los datos muestran que Email Marketing tiene 4.8% conversion rate en King Size vs 1.9% promedio en TikTok. Esta granularidad permite optimizar €6,950/mes additional revenue solo ajustando budget allocation por atributo-canal. <strong>ROI potencial: 340% en 6 meses.</strong></p>
            </div>
        </div>

        <!-- Call to Action -->
        <div class="cta-section">
            <h3 style="font-size: 1.6rem; margin-bottom: 15px;">¿Listo para optimizar cada medida y material por canal?</h3>
            <p style="font-size: 1.1rem; margin-bottom: 20px;">
                Descubre cómo MiColchón puede aumentar conversiones +23% con product intelligence granular
            </p>
            <a href="https://calendly.com/sealmetrics/demo-micolchon" class="cta-button">
                📅 Agendar Demo Personalizada (15 min)
            </a>
            
            <div style="margin-top: 20px; font-size: 0.9rem; opacity: 0.9;">
                <p>✓ Setup técnico en < 2 días</p>
                <p>✓ Zero impacto en performance web</p>
                <p>✓ GDPR compliance automático</p>
                <p>✓ Product intelligence completo</p>
            </div>
        </div>
    </div>

    <script>
        // Datos para la matriz interactiva
        const matrixData = {
            medidas: {
                headers: ['90x190', '135x190', '150x190', '160x190', '180x200'],
                facebook: ['2.8%', '3.2%', '4.1%', '3.6%', '2.9%'],
                google: ['2.1%', '3.8%', '3.4%', '4.5%', '4.2%'],
                instagram: ['3.7%', '3.1%', '2.9%', '2.4%', '2.1%'],
                email: ['3.2%', '3.6%', '3.8%', '4.8%', '5.1%'],
                tiktok: ['2.9%', '2.3%', '1.8%', '1.4%', '1.1%'],
                averages: ['2.9%', '3.2%', '3.2%', '3.3%', '3.1%']
            },
            materiales: {
                headers: ['Viscoelástica', 'Muelles', 'Látex', 'Híbrido', 'Espuma HR'],
                facebook: ['4.2%', '3.1%', '3.8%', '3.2%', '2.1%'],
                google: ['3.9%', '3.5%', '4.1%', '3.8%', '2.3%'],
                instagram: ['3.4%', '2.8%', '4.2%', '2.9%', '2.5%'],
                email: ['4.8%', '3.7%', '4.5%', '4.1%', '2.8%'],
                tiktok: ['2.1%', '2.4%', '2.8%', '2.2%', '1.9%'],
                averages: ['3.7%', '3.1%', '3.9%', '3.2%', '2.3%']
            },
            firmeza: {
                headers: ['Suave', 'Media', 'Firme', 'Extra Firme'],
                facebook: ['3.1%', '3.8%', '3.4%', '2.9%'],
                google: ['2.8%', '4.1%', '3.7%', '3.2%'],
                instagram: ['3.9%', '3.2%', '2.6%', '2.1%'],
                email: ['4.2%', '4.6%', '4.1%', '3.8%'],
                tiktok: ['2.3%', '2.1%', '1.8%', '1.5%'],
                averages: ['3.3%', '3.6%', '3.1%', '2.7%']
            },
            precios: {
                headers: ['€100-300', '€301-600', '€601-1000', '€1000+'],
                facebook: ['3.2%', '3.6%', '2.8%', '2.1%'],
                google: ['2.9%', '4.1%', '3.9%', '3.2%'],
                instagram: ['3.8%', '2.9%', '2.3%', '1.8%'],
                email: ['3.4%', '4.2%', '4.8%', '5.1%'],
                tiktok: ['2.8%', '2.1%', '1.6%', '1.2%'],
                averages: ['3.2%', '3.4%', '3.1%', '2.7%']
            }
        };

        const insights = {
            medidas: 'Email Marketing domina medidas grandes (King/Super King) con 4.8-5.1% conversion. Instagram optimal para Individual (3.7%). Google Shopping strong en matrimonio tradicional. TikTok underperforming across all sizes.',
            materiales: 'Viscoelástica y Látex tienen mejor performance en Email (4.8% y 4.5%). Instagram sorprendente strong con Látex Natural (4.2%) - target eco-conscious young adults. Espuma HR struggling across channels.',
            firmeza: 'Firmeza Media domina en todos los canales (3.6% average). Email excels con todos los niveles de firmeza. Instagram prefiere Suave (3.9%) - younger demographic preference. Extra Firme challenging segment.',
            precios: 'Email Marketing domina productos premium €1000+ (5.1% conversion). TikTok mejor en entry-level €100-300. Google Shopping sweet spot en €301-600 range. Premium products requieren email nurturing sequences.'
        };

        function updateMatrix() {
            const selectedAttribute = document.getElementById('attributeSelector').value;
            const data = matrixData[selectedAttribute];
            
            // Update header
            const header = document.getElementById('matrixHeader');
            const attributeNames = {
                medidas: 'Medida',
                materiales: 'Material', 
                firmeza: 'Firmeza',
                precios: 'Precio'
            };
            
            header.innerHTML = `<th>Canal / ${attributeNames[selectedAttribute]}</th>`;
            data.headers.forEach(h => {
                header.innerHTML += `<th>${h}</th>`;
            });
            header.innerHTML += '<th style="background: #e2e8f0; color: #4a5568;">Media Canal</th>';
            
            // Update body
            const body = document.getElementById('matrixBody');
            const channels = [
                {name: 'Facebook Ads', key: 'facebook', class: 'facebook'},
                {name: 'Google Shopping', key: 'google', class: 'google'},
                {name: 'Instagram', key: 'instagram', class: 'instagram'},
                {name: 'Email Marketing', key: 'email', class: 'email'},
                {name: 'TikTok Ads', key: 'tiktok', class: 'tiktok'}
            ];
            
            body.innerHTML = '';
            
            channels.forEach(channel => {
                const row = document.createElement('tr');
                row.className = `channel-row ${channel.class}`;
                row.innerHTML = `<td><strong>${channel.name}</strong></td>`;
                
                data[channel.key].forEach((value, index) => {
                    const cell = document.createElement('td');
                    cell.textContent = value;
                    
                    // Highlight best performers
                    const numValue = parseFloat(value);
                    const avgValue = parseFloat(data.averages[index]);
                    if (numValue > avgValue * 1.2) {
                        cell.className = 'highlight';
                    }
                    row.appendChild(cell);
                });
                
                // Add channel average
                const avgCell = document.createElement('td');
                avgCell.style.background = '#e2e8f0';
                const channelAvg = data[channel.key].reduce((sum, val) => sum + parseFloat(val), 0) / data[channel.key].length;
                avgCell.innerHTML = `<strong>${channelAvg.toFixed(1)}%</strong>`;
                row.appendChild(avgCell);
                
                body.appendChild(row);
            });
            
            // Add average row
            const avgRow = document.createElement('tr');
            avgRow.className = 'average-row';
            avgRow.innerHTML = '<td class="total-cell"><strong>MEDIA SITE</strong></td>';
            
            data.averages.forEach(avg => {
                avgRow.innerHTML += `<td>${avg}</td>`;
            });
            
            const totalAvg = data.averages.reduce((sum, val) => sum + parseFloat(val), 0) / data.averages.length;
            avgRow.innerHTML += `<td class="total-cell"><strong>${totalAvg.toFixed(1)}%</strong></td>`;
            
            body.appendChild(avgRow);
            
            // Update insights
            document.getElementById('matrixInsights').innerHTML = 
                `<h4>🔍 Insights Dinámicos - ${attributeNames[selectedAttribute]}</h4><p>${insights[selectedAttribute]}</p>`;
        }

        // Initialize with default view
        document.addEventListener('DOMContentLoaded', function() {
            updateMatrix();
        });
    </script>
</body>
</html>